<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />
    <link rel="stylesheet" type="text/css" href="stylesheets/shi_whatis.min.css" rel='stylesheet' type='text/css'/>

    <script src="javascripts/jquery-2.1.1.min.js"></script>
    <script src="javascripts/shi_jquery.min.js"></script>

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Notebook by aras7</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1><a href="index.html">Notebook</a></h1>
          <h2></h2>
        </header>

        <section class="clearfix">
          <a href="index.html" class="button">Back to menu</a>
        </section>

        <hr>

        <section id="main_content">

          <h3>KMP</h3>

          <a href="http://en.wikipedia.org/wiki/Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm">wikipedia.org</a>

<!-- start code -->
<div class="snippet-container">
   <div class="sh_whatis snippet-wrap">
      <div class="snippet-menu sh_sourceCode"><a class="snippet-window sh_url" href="#">pop-up</a><a class="snippet-text sh_url" href="#">text</a></div>
      <pre class="shi_pre sh_cpp snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_type">char</span> str<span class="sh_symbol">[</span>MAX<span class="sh_symbol">];</span></li><li><span class="sh_type">void</span> <span class="sh_function">KMP</span><span class="sh_symbol">(</span><span class="sh_type">int</span> N<span class="sh_symbol">,</span><span class="sh_type">char</span> to_search<span class="sh_symbol">[])</span></li><li><span class="sh_cbracket">{</span></li><li>    <span class="sh_type">int</span> comp<span class="sh_symbol">[</span>N<span class="sh_number">+7</span><span class="sh_symbol">];</span></li><li>    <span class="sh_function">memset</span><span class="sh_symbol">(</span>comp<span class="sh_symbol">,</span><span class="sh_number">0</span><span class="sh_symbol">,</span><span class="sh_keyword">sizeof</span> comp<span class="sh_symbol">);</span></li><li>    comp<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_symbol">;</span></li><li>    </li><li>    <span class="sh_keyword">for</span><span class="sh_symbol">(</span><span class="sh_type">int</span> i <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span>i <span class="sh_symbol">&lt;</span> N<span class="sh_symbol">;</span>i<span class="sh_symbol">++)</span>  </li><li>        <span class="sh_keyword">for</span><span class="sh_symbol">(</span><span class="sh_type">int</span> x <span class="sh_symbol">=</span> comp<span class="sh_symbol">[</span>i<span class="sh_symbol">];</span><span class="sh_keyword">true</span><span class="sh_symbol">;)</span></li><li>            <span class="sh_keyword">if</span><span class="sh_symbol">(</span>to_search<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">!=</span> to_search<span class="sh_symbol">[</span>x<span class="sh_symbol">])</span></li><li>            <span class="sh_cbracket">{</span>                 </li><li>                x <span class="sh_symbol">=</span> comp<span class="sh_symbol">[</span>x<span class="sh_symbol">];</span></li><li>                <span class="sh_keyword">if</span><span class="sh_symbol">(</span>x <span class="sh_symbol">==</span> <span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_symbol">)</span></li><li>                <span class="sh_cbracket">{</span></li><li>                   comp<span class="sh_symbol">[</span>i<span class="sh_number">+1</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span></li><li>                   <span class="sh_keyword">break</span><span class="sh_symbol">;</span></li><li>                <span class="sh_cbracket">}</span></li><li>            <span class="sh_cbracket">}</span></li><li>            <span class="sh_keyword">else</span></li><li>            <span class="sh_cbracket">{</span></li><li>                comp<span class="sh_symbol">[</span>i<span class="sh_number">+1</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> x<span class="sh_number">+1</span><span class="sh_symbol">;</span></li><li>                <span class="sh_keyword">break</span><span class="sh_symbol">;</span></li><li>            <span class="sh_cbracket">}</span></li><li>    </li><li>    <span class="sh_type">int</span> _i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>size <span class="sh_symbol">=</span> <span class="sh_function">strlen</span><span class="sh_symbol">(</span>str<span class="sh_symbol">);</span></li><li>        </li><li>    <span class="sh_keyword">while</span><span class="sh_symbol">(</span>i <span class="sh_symbol">&lt;</span> size<span class="sh_symbol">)</span></li><li>    <span class="sh_cbracket">{</span></li><li>        <span class="sh_keyword">if</span><span class="sh_symbol">(</span>to_search<span class="sh_symbol">[</span>_i<span class="sh_symbol">]</span> <span class="sh_symbol">==</span> str<span class="sh_symbol">[</span>i<span class="sh_symbol">])</span></li><li>        <span class="sh_cbracket">{</span></li><li>             <span class="sh_keyword">if</span><span class="sh_symbol">(</span>_i <span class="sh_symbol">==</span> <span class="sh_symbol">(</span>N<span class="sh_number">-1</span><span class="sh_symbol">))</span></li><li>             <span class="sh_cbracket">{</span></li><li>                 <span class="sh_function">printf</span><span class="sh_symbol">(</span><span class="sh_string">"%d</span><span class="sh_specialchar">\n</span><span class="sh_string">"</span><span class="sh_symbol">,</span>i<span class="sh_symbol">-</span>N<span class="sh_number">+1</span><span class="sh_symbol">);</span></li><li>                 _i <span class="sh_symbol">=</span> comp<span class="sh_symbol">[</span>N<span class="sh_symbol">];</span></li><li>             <span class="sh_cbracket">}</span></li><li>             <span class="sh_keyword">else</span> </li><li>                 _i<span class="sh_symbol">++;</span></li><li>                      </li><li>             i<span class="sh_symbol">++;</span>         </li><li>        <span class="sh_cbracket">}</span></li><li>        <span class="sh_keyword">else</span></li><li>        <span class="sh_cbracket">{</span></li><li>            _i <span class="sh_symbol">=</span> comp<span class="sh_symbol">[</span>_i<span class="sh_symbol">];</span></li><li>            <span class="sh_keyword">if</span><span class="sh_symbol">(</span>_i <span class="sh_symbol">==</span> <span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_symbol">)</span></li><li>                _i<span class="sh_symbol">++,</span>i<span class="sh_symbol">++;</span></li><li>        <span class="sh_cbracket">}</span></li><li>    <span class="sh_cbracket">}</span></li><li><span class="sh_cbracket">}</span></li></ol></pre>
      <pre class="snippet-textonly sh_sourceCode" style="display:none;" tabindex="0" contenteditable="">char str[MAX];
void KMP(int N,char to_search[])
{
    int comp[N+7];
    memset(comp,0,sizeof comp);
    comp[0] = -1;
    
    for(int i = 1;i &lt; N;i++)  
        for(int x = comp[i];true;)
            if(to_search[i] != to_search[x])
            {                 
                x = comp[x];
                if(x == -1)
                {
                   comp[i+1] = 0;
                   break;
                }
            }
            else
            {
                comp[i+1] = x+1;
                break;
            }
    
    int _i = 0,i = 0,size = strlen(str);
        
    while(i &lt; size)
    {
        if(to_search[_i] == str[i])
        {
             if(_i == (N-1))
             {
                 printf("%d\n",i-N+1);
                 _i = comp[N];
             }
             else 
                 _i++;
                      
             i++;         
        }
        else
        {
            _i = comp[_i];
            if(_i == -1)
                _i++,i++;
        }
    }
}</pre>
   </div>
</div>
<!-- end code -->
<!--
          <pre><code>
char str[MAX];
void KMP(int N,char to_search[])
{
    int comp[N+7];
    memset(comp,0,sizeof comp);
    comp[0] = -1;
    
    for(int i = 1;i < N;i++)  
        for(int x = comp[i];true;)
            if(to_search[i] != to_search[x])
            {                 
                x = comp[x];
                if(x == -1)
                {
                   comp[i+1] = 0;
                   break;
                }
            }
            else
            {
                comp[i+1] = x+1;
                break;
            }
    
    int _i = 0,i = 0,size = strlen(str);
        
    while(i < size)
    {
        if(to_search[_i] == str[i])
        {
             if(_i == (N-1))
             {
                 printf("%d\n",i-N+1);
                 _i = comp[N];
             }
             else 
                 _i++;
                      
             i++;         
        }
        else
        {
            _i = comp[_i];
            if(_i == -1)
                _i++,i++;
        }
    }
}
</code></pre>
-->


          <h3>If you need to find 2D strings use this</h3>

<!-- start code -->
<div class="snippet-container">
   <div class="sh_whatis snippet-wrap">
      <div class="snippet-menu sh_sourceCode"><a class="snippet-window sh_url" href="#">pop-up</a><a class="snippet-text sh_url" href="#">text</a></div>
      <pre class="shi_pre sh_cpp snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_type">bool</span> <span class="sh_function">CMP</span><span class="sh_symbol">(</span><span class="sh_usertype">pair&lt;int,int&gt; a,pair&lt;int,int&gt;</span><span class="sh_normal"> </span>b<span class="sh_symbol">)</span></li><li><span class="sh_cbracket">{</span></li><li>     <span class="sh_keyword">return</span> a<span class="sh_symbol">.</span>first <span class="sh_symbol">!=</span> b<span class="sh_symbol">.</span>first <span class="sh_symbol">?</span> a<span class="sh_symbol">.</span>first <span class="sh_symbol">&lt;</span> b<span class="sh_symbol">.</span>first <span class="sh_symbol">:</span> a<span class="sh_symbol">.</span>second <span class="sh_symbol">&lt;</span> b<span class="sh_symbol">.</span>second<span class="sh_symbol">;</span></li><li><span class="sh_cbracket">}</span></li><li></li><li><span class="sh_usertype">vector&lt;int&gt;</span><span class="sh_normal"> </span><span class="sh_function">PRE</span><span class="sh_symbol">(</span>vector<span class="sh_symbol">&lt;</span><span class="sh_type">char</span><span class="sh_symbol">&gt;</span>to_search<span class="sh_symbol">)</span></li><li><span class="sh_cbracket">{</span></li><li>    <span class="sh_type">int</span> N <span class="sh_symbol">=</span> to_search<span class="sh_symbol">.</span><span class="sh_function">size</span><span class="sh_symbol">();</span></li><li>    <span class="sh_usertype">vector&lt;int&gt;</span><span class="sh_normal"> </span><span class="sh_function">comp</span><span class="sh_symbol">(</span>N <span class="sh_symbol">+</span> <span class="sh_number">7</span><span class="sh_symbol">,</span><span class="sh_number">0</span><span class="sh_symbol">);</span></li><li></li><li>    comp<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_symbol">;</span></li><li>    </li><li>    <span class="sh_keyword">for</span><span class="sh_symbol">(</span><span class="sh_type">int</span> i <span class="sh_symbol">=</span> <span class="sh_number">1</span><span class="sh_symbol">;</span>i <span class="sh_symbol">&lt;</span> N<span class="sh_symbol">;</span>i<span class="sh_symbol">++)</span>  </li><li>        <span class="sh_keyword">for</span><span class="sh_symbol">(</span><span class="sh_type">int</span> x <span class="sh_symbol">=</span> comp<span class="sh_symbol">[</span>i<span class="sh_symbol">];</span><span class="sh_keyword">true</span><span class="sh_symbol">;)</span></li><li>            <span class="sh_keyword">if</span><span class="sh_symbol">(</span>to_search<span class="sh_symbol">[</span>i<span class="sh_symbol">]</span> <span class="sh_symbol">!=</span> to_search<span class="sh_symbol">[</span>x<span class="sh_symbol">])</span></li><li>            <span class="sh_cbracket">{</span>                 </li><li>                x <span class="sh_symbol">=</span> comp<span class="sh_symbol">[</span>x<span class="sh_symbol">];</span></li><li>                <span class="sh_keyword">if</span><span class="sh_symbol">(</span>x <span class="sh_symbol">==</span> <span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_symbol">)</span></li><li>                <span class="sh_cbracket">{</span></li><li>                   comp<span class="sh_symbol">[</span>i<span class="sh_number">+1</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span></li><li>                   <span class="sh_keyword">break</span><span class="sh_symbol">;</span></li><li>                <span class="sh_cbracket">}</span></li><li>            <span class="sh_cbracket">}</span></li><li>            <span class="sh_keyword">else</span></li><li>            <span class="sh_cbracket">{</span></li><li>                comp<span class="sh_symbol">[</span>i<span class="sh_number">+1</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> x<span class="sh_number">+1</span><span class="sh_symbol">;</span></li><li>                <span class="sh_keyword">break</span><span class="sh_symbol">;</span></li><li>            <span class="sh_cbracket">}</span></li><li>            </li><li>    <span class="sh_keyword">return</span> comp<span class="sh_symbol">;</span></li><li><span class="sh_cbracket">}</span></li><li></li><li><span class="sh_type">void</span> <span class="sh_function">KMP_2D</span><span class="sh_symbol">(</span>vector<span class="sh_symbol">&lt;</span>vector<span class="sh_symbol">&lt;</span><span class="sh_type">char</span><span class="sh_symbol">&gt;</span> <span class="sh_symbol">&gt;</span>to_search <span class="sh_symbol">,</span> vector<span class="sh_symbol">&lt;</span>vector<span class="sh_symbol">&lt;</span><span class="sh_type">char</span><span class="sh_symbol">&gt;</span> <span class="sh_symbol">&gt;</span>__MAP<span class="sh_symbol">,</span><span class="sh_type">int</span> N1<span class="sh_symbol">,</span><span class="sh_type">int</span> N2<span class="sh_symbol">,</span><span class="sh_type">int</span> M1<span class="sh_symbol">,</span><span class="sh_type">int</span> M2<span class="sh_symbol">)</span></li><li><span class="sh_cbracket">{</span></li><li>     <span class="sh_usertype">vector&lt;vector&lt;int&gt; &gt;</span><span class="sh_normal"> </span><span class="sh_function">VAL</span><span class="sh_symbol">(</span>M1 <span class="sh_symbol">+</span> <span class="sh_number">7</span> <span class="sh_symbol">,</span> vector<span class="sh_symbol">&lt;</span><span class="sh_type">int</span><span class="sh_symbol">&gt;(</span>M2 <span class="sh_symbol">+</span> <span class="sh_number">7</span> <span class="sh_symbol">,</span> <span class="sh_number">0</span><span class="sh_symbol">));</span></li><li>     </li><li>     vector<span class="sh_symbol">&lt;</span>pair<span class="sh_symbol">&lt;</span><span class="sh_type">int</span><span class="sh_symbol">,</span><span class="sh_type">int</span><span class="sh_symbol">&gt;</span> <span class="sh_symbol">&gt;</span>answer<span class="sh_symbol">;</span></li><li>     </li><li>     <span class="sh_keyword">for</span><span class="sh_symbol">(</span><span class="sh_type">int</span> k <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>k <span class="sh_symbol">&lt;</span> N1<span class="sh_symbol">;</span>k<span class="sh_symbol">++)</span></li><li>     <span class="sh_cbracket">{</span></li><li>         <span class="sh_usertype">vector&lt;int&gt;</span><span class="sh_normal"> </span>comp <span class="sh_symbol">=</span> <span class="sh_function">PRE</span><span class="sh_symbol">(</span>to_search<span class="sh_symbol">[</span>k<span class="sh_symbol">]);</span></li><li></li><li>         <span class="sh_keyword">for</span><span class="sh_symbol">(</span><span class="sh_type">int</span> p <span class="sh_symbol">=</span> M1 <span class="sh_symbol">-</span> N1 <span class="sh_symbol">+</span> k<span class="sh_symbol">;</span>p <span class="sh_symbol">&gt;=</span> k<span class="sh_symbol">;</span>p<span class="sh_symbol">--)</span></li><li>         <span class="sh_cbracket">{</span></li><li>             <span class="sh_type">int</span> _i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">,</span>size <span class="sh_symbol">=</span> __MAP<span class="sh_symbol">[</span>p<span class="sh_symbol">].</span><span class="sh_function">size</span><span class="sh_symbol">();</span></li><li>             </li><li>             <span class="sh_usertype">vector&lt;char&gt;</span><span class="sh_normal"> </span>str <span class="sh_symbol">=</span> __MAP<span class="sh_symbol">[</span>p<span class="sh_symbol">];</span></li><li>               </li><li>             <span class="sh_keyword">while</span><span class="sh_symbol">(</span>i <span class="sh_symbol">&lt;</span> size<span class="sh_symbol">)</span></li><li>             <span class="sh_cbracket">{</span></li><li>                 <span class="sh_keyword">if</span><span class="sh_symbol">(</span>to_search<span class="sh_symbol">[</span>k<span class="sh_symbol">][</span>_i<span class="sh_symbol">]</span> <span class="sh_symbol">==</span> str<span class="sh_symbol">[</span>i<span class="sh_symbol">])</span></li><li>                 <span class="sh_cbracket">{</span></li><li>                      <span class="sh_keyword">if</span><span class="sh_symbol">(</span>_i <span class="sh_symbol">==</span> <span class="sh_symbol">(</span>N2 <span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_symbol">))</span></li><li>                      <span class="sh_cbracket">{</span></li><li>                          <span class="sh_keyword">if</span><span class="sh_symbol">(</span>VAL<span class="sh_symbol">[</span><span class="sh_function">max</span><span class="sh_symbol">(</span><span class="sh_number">0</span><span class="sh_symbol">,</span>p <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">)][</span>i <span class="sh_symbol">-</span> N2 <span class="sh_symbol">+</span> <span class="sh_number">1</span><span class="sh_symbol">]</span> <span class="sh_symbol">==</span> k<span class="sh_symbol">)</span></li><li>                          <span class="sh_cbracket">{</span>   </li><li>                              <span class="sh_keyword">if</span><span class="sh_symbol">(</span>k <span class="sh_symbol">!=</span> N1 <span class="sh_symbol">-</span> <span class="sh_number">1</span><span class="sh_symbol">)</span></li><li>                                  VAL<span class="sh_symbol">[</span>p<span class="sh_symbol">][</span>i <span class="sh_symbol">-</span> N2 <span class="sh_symbol">+</span> <span class="sh_number">1</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> k <span class="sh_symbol">+</span> <span class="sh_number">1</span><span class="sh_symbol">;</span></li><li>                              <span class="sh_keyword">else</span></li><li>                                  answer<span class="sh_symbol">.</span><span class="sh_function">push_back</span><span class="sh_symbol">(</span>pair<span class="sh_symbol">&lt;</span><span class="sh_type">int</span><span class="sh_symbol">,</span><span class="sh_type">int</span><span class="sh_symbol">&gt;(</span> p <span class="sh_symbol">-</span> N1 <span class="sh_symbol">+</span> <span class="sh_number">2</span> <span class="sh_symbol">,</span> i <span class="sh_symbol">-</span> N2 <span class="sh_symbol">+</span> <span class="sh_number">2</span> <span class="sh_symbol">));</span></li><li>                          <span class="sh_cbracket">}</span></li><li>                          </li><li>                          _i <span class="sh_symbol">=</span> comp<span class="sh_symbol">[</span>N2 <span class="sh_symbol">];</span></li><li>                     <span class="sh_cbracket">}</span></li><li>                      <span class="sh_keyword">else</span> </li><li>                          _i<span class="sh_symbol">++;</span></li><li>                              </li><li>                      i<span class="sh_symbol">++;</span>         </li><li>                 <span class="sh_cbracket">}</span></li><li>                 <span class="sh_keyword">else</span></li><li>                 <span class="sh_cbracket">{</span></li><li>                     _i <span class="sh_symbol">=</span> comp<span class="sh_symbol">[</span>_i<span class="sh_symbol">];</span></li><li>                     <span class="sh_keyword">if</span><span class="sh_symbol">(</span>_i <span class="sh_symbol">==</span> <span class="sh_symbol">-</span><span class="sh_number">1</span><span class="sh_symbol">)</span></li><li>                         _i<span class="sh_symbol">++,</span>i<span class="sh_symbol">++;</span></li><li>                 <span class="sh_cbracket">}</span></li><li>             <span class="sh_cbracket">}</span></li><li>         <span class="sh_cbracket">}</span></li><li>     <span class="sh_cbracket">}</span></li><li>     </li><li>     <span class="sh_function">sort</span><span class="sh_symbol">(</span>answer<span class="sh_symbol">.</span><span class="sh_function">begin</span><span class="sh_symbol">(),</span>answer<span class="sh_symbol">.</span><span class="sh_function">end</span><span class="sh_symbol">(),</span>CMP<span class="sh_symbol">);</span></li><li>     <span class="sh_keyword">for</span><span class="sh_symbol">(</span><span class="sh_type">int</span> j <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>j <span class="sh_symbol">&lt;</span> answer<span class="sh_symbol">.</span><span class="sh_function">size</span><span class="sh_symbol">();</span>j<span class="sh_symbol">++)</span></li><li>         <span class="sh_function">printf</span><span class="sh_symbol">(</span><span class="sh_string">"(%d,%d)</span><span class="sh_specialchar">\n</span><span class="sh_string">"</span><span class="sh_symbol">,</span>answer<span class="sh_symbol">[</span>j<span class="sh_symbol">].</span>first<span class="sh_symbol">,</span>answer<span class="sh_symbol">[</span>j<span class="sh_symbol">].</span>second<span class="sh_symbol">);</span></li><li>         </li><li>     <span class="sh_keyword">if</span><span class="sh_symbol">(!</span>answer<span class="sh_symbol">.</span><span class="sh_function">size</span><span class="sh_symbol">())</span></li><li>         <span class="sh_function">puts</span><span class="sh_symbol">(</span><span class="sh_string">"NO MATCH FOUND..."</span><span class="sh_symbol">);</span></li><li><span class="sh_cbracket">}</span></li></ol></pre>
      <pre class="snippet-textonly sh_sourceCode" style="display:none;" tabindex="0" contenteditable="">bool CMP(pair&lt;int,int&gt; a,pair&lt;int,int&gt; b)
{
     return a.first != b.first ? a.first &lt; b.first : a.second &lt; b.second;
}

vector&lt;int&gt; PRE(vector&lt;char&gt;to_search)
{
    int N = to_search.size();
    vector&lt;int&gt; comp(N + 7,0);

    comp[0] = -1;
    
    for(int i = 1;i &lt; N;i++)  
        for(int x = comp[i];true;)
            if(to_search[i] != to_search[x])
            {                 
                x = comp[x];
                if(x == -1)
                {
                   comp[i+1] = 0;
                   break;
                }
            }
            else
            {
                comp[i+1] = x+1;
                break;
            }
            
    return comp;
}

void KMP_2D(vector&lt;vector&lt;char&gt; &gt;to_search , vector&lt;vector&lt;char&gt; &gt;__MAP,int N1,int N2,int M1,int M2)
{
     vector&lt;vector&lt;int&gt; &gt; VAL(M1 + 7 , vector&lt;int&gt;(M2 + 7 , 0));
     
     vector&lt;pair&lt;int,int&gt; &gt;answer;
     
     for(int k = 0;k &lt; N1;k++)
     {
         vector&lt;int&gt; comp = PRE(to_search[k]);

         for(int p = M1 - N1 + k;p &gt;= k;p--)
         {
             int _i = 0,i = 0,size = __MAP[p].size();
             
             vector&lt;char&gt; str = __MAP[p];
               
             while(i &lt; size)
             {
                 if(to_search[k][_i] == str[i])
                 {
                      if(_i == (N2 -1))
                      {
                          if(VAL[max(0,p - 1)][i - N2 + 1] == k)
                          {   
                              if(k != N1 - 1)
                                  VAL[p][i - N2 + 1] = k + 1;
                              else
                                  answer.push_back(pair&lt;int,int&gt;( p - N1 + 2 , i - N2 + 2 ));
                          }
                          
                          _i = comp[N2 ];
                     }
                      else 
                          _i++;
                              
                      i++;         
                 }
                 else
                 {
                     _i = comp[_i];
                     if(_i == -1)
                         _i++,i++;
                 }
             }
         }
     }
     
     sort(answer.begin(),answer.end(),CMP);
     for(int j = 0;j &lt; answer.size();j++)
         printf("(%d,%d)\n",answer[j].first,answer[j].second);
         
     if(!answer.size())
         puts("NO MATCH FOUND...");
}</pre>
   </div>
</div>
<!-- end code -->
<!--
          <pre><code>
bool CMP(pair<int,int> a,pair<int,int> b)
{
     return a.first != b.first ? a.first < b.first : a.second < b.second;
}

vector<int> PRE(vector<char>to_search)
{
    int N = to_search.size();
    vector<int> comp(N + 7,0);

    comp[0] = -1;
    
    for(int i = 1;i < N;i++)  
        for(int x = comp[i];true;)
            if(to_search[i] != to_search[x])
            {                 
                x = comp[x];
                if(x == -1)
                {
                   comp[i+1] = 0;
                   break;
                }
            }
            else
            {
                comp[i+1] = x+1;
                break;
            }
            
    return comp;
}

void KMP_2D(vector<vector<char> >to_search , vector<vector<char> >__MAP,int N1,int N2,int M1,int M2)
{
     vector<vector<int> > VAL(M1 + 7 , vector<int>(M2 + 7 , 0));
     
     vector<pair<int,int> >answer;
     
     for(int k = 0;k < N1;k++)
     {
         vector<int> comp = PRE(to_search[k]);

         for(int p = M1 - N1 + k;p >= k;p--)
         {
             int _i = 0,i = 0,size = __MAP[p].size();
             
             vector<char> str = __MAP[p];
               
             while(i < size)
             {
                 if(to_search[k][_i] == str[i])
                 {
                      if(_i == (N2 -1))
                      {
                          if(VAL[max(0,p - 1)][i - N2 + 1] == k)
                          {   
                              if(k != N1 - 1)
                                  VAL[p][i - N2 + 1] = k + 1;
                              else
                                  answer.push_back(pair<int,int>( p - N1 + 2 , i - N2 + 2 ));
                          }
                          
                          _i = comp[N2 ];
                     }
                      else 
                          _i++;
                              
                      i++;         
                 }
                 else
                 {
                     _i = comp[_i];
                     if(_i == -1)
                         _i++,i++;
                 }
             }
         }
     }
     
     sort(answer.begin(),answer.end(),CMP);
     for(int j = 0;j < answer.size();j++)
         printf("(%d,%d)\n",answer[j].first,answer[j].second);
         
     if(!answer.size())
         puts("NO MATCH FOUND...");
}

          </code></pre>
 -->
        </section>

        <footer>
          Notebook is maintained by <a href="https://github.com/aras7">aras7</a><br>
          <a target="blank"href="http://stackoverflow.com/users/1437986/andres">
          <img src="http://stackoverflow.com/users/flair/1437986.png" width="208" height="58" alt="profile for Andres at Stack Overflow, Q&amp;A for professional and enthusiast programmers" title="profile for Andres at Stack Overflow, Q&amp;A for professional and enthusiast programmers">
          </a>
          <br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>
      </div>
    </div>
  </body>
</html>
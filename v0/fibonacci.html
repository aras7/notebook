<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />
    <link rel="stylesheet" type="text/css" href="stylesheets/shi_whatis.min.css" rel='stylesheet' type='text/css'/>

    <script src="javascripts/jquery-2.1.1.min.js"></script>
    <script src="javascripts/shi_jquery.min.js"></script>

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Notebook by aras7</title>
  </head>


  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1><a href="index.html">Notebook</a></h1>
          <h2></h2>
        </header>

        <section class="clearfix">
          <a href="index.html" class="button">Back to menu</a>
        </section>

        <hr>

        <section id="main_content">

          <h3>Fibonacci</h3>

          <p><a href="http://nayuki.eigenstate.org/page/fast-fibonacci-algorithms">doc</a></p>
<!-- start code -->
<div class="snippet-container">
   <div class="sh_whatis snippet-wrap">
      <div class="snippet-menu sh_sourceCode"><a class="snippet-window sh_url" href="#">pop-up</a><a class="snippet-text sh_url" href="#">text</a></div>
      <pre class="shi_pre sh_cpp snippet-formatted sh_sourceCode"><ol class="snippet-num"><li><span class="sh_keyword">typedef</span> <span class="sh_type">long</span> <span class="sh_type">long</span> type<span class="sh_symbol">;</span></li><li><span class="sh_keyword">typedef</span> <span class="sh_usertype">vector&lt;type&gt;</span><span class="sh_normal"> </span>row_t<span class="sh_symbol">;</span></li><li><span class="sh_keyword">typedef</span> <span class="sh_usertype">vector&lt;row_t&gt;</span><span class="sh_normal"> </span>matrix_t<span class="sh_symbol">;</span></li><li></li><li>matrix_t <span class="sh_function">_square_matrix</span><span class="sh_symbol">(</span><span class="sh_type">int</span> size<span class="sh_symbol">,</span> <span class="sh_type">int</span> value<span class="sh_symbol">)</span></li><li><span class="sh_cbracket">{</span></li><li>    <span class="sh_keyword">return</span> <span class="sh_function">matrix_t</span><span class="sh_symbol">(</span>size <span class="sh_symbol">,</span> <span class="sh_function">row_t</span><span class="sh_symbol">(</span>size <span class="sh_symbol">,</span> value<span class="sh_symbol">));</span></li><li><span class="sh_cbracket">}</span></li><li></li><li><span class="sh_usertype">matrix_t</span><span class="sh_normal"> </span><span class="sh_function">multiply</span><span class="sh_symbol">(</span><span class="sh_usertype">matrix_t</span><span class="sh_normal"> </span>A<span class="sh_symbol">,</span><span class="sh_usertype">matrix_t</span><span class="sh_normal"> </span>B<span class="sh_symbol">,</span><span class="sh_usertype">type</span><span class="sh_normal"> </span>mod<span class="sh_symbol">)</span></li><li><span class="sh_cbracket">{</span></li><li>    <span class="sh_type">int</span> size <span class="sh_symbol">=</span> A<span class="sh_symbol">.</span><span class="sh_function">size</span><span class="sh_symbol">();</span></li><li>    </li><li>    <span class="sh_usertype">matrix_t</span><span class="sh_normal"> </span>C <span class="sh_symbol">=</span> <span class="sh_function">_square_matrix</span><span class="sh_symbol">(</span>size<span class="sh_symbol">,</span><span class="sh_number">0</span><span class="sh_symbol">);</span></li><li></li><li>    <span class="sh_keyword">for</span><span class="sh_symbol">(</span><span class="sh_type">int</span> k<span class="sh_symbol">,</span>j<span class="sh_symbol">,</span>t<span class="sh_symbol">,</span>i <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>i <span class="sh_symbol">&lt;</span> size<span class="sh_symbol">;</span>i<span class="sh_symbol">++)</span></li><li>       <span class="sh_keyword">for</span><span class="sh_symbol">(</span><span class="sh_type">int</span> j <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>j <span class="sh_symbol">&lt;</span> size<span class="sh_symbol">;</span>j<span class="sh_symbol">++)</span></li><li>       <span class="sh_cbracket">{</span></li><li>             <span class="sh_keyword">for</span><span class="sh_symbol">(</span>t <span class="sh_symbol">=</span> k <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span>k <span class="sh_symbol">&lt;</span> size<span class="sh_symbol">;</span>k<span class="sh_symbol">++)</span></li><li>                 t <span class="sh_symbol">=</span> <span class="sh_symbol">(</span>t <span class="sh_symbol">+</span> A<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>k<span class="sh_symbol">]</span> <span class="sh_symbol">*</span> B<span class="sh_symbol">[</span>k<span class="sh_symbol">][</span>j<span class="sh_symbol">]</span> <span class="sh_symbol">%</span> mod<span class="sh_symbol">)</span> <span class="sh_symbol">%</span> mod<span class="sh_symbol">;</span></li><li>                 </li><li>             C<span class="sh_symbol">[</span>i<span class="sh_symbol">][</span>j<span class="sh_symbol">]</span> <span class="sh_symbol">=</span> t<span class="sh_symbol">;</span></li><li>       <span class="sh_cbracket">}</span></li><li>       </li><li>    <span class="sh_keyword">return</span> C<span class="sh_symbol">;</span></li><li><span class="sh_cbracket">}</span></li><li></li><li><span class="sh_usertype">matrix_t</span><span class="sh_normal"> </span><span class="sh_function">power</span><span class="sh_symbol">(</span><span class="sh_usertype">matrix_t</span><span class="sh_normal"> </span>A<span class="sh_symbol">,</span><span class="sh_type">int</span> n<span class="sh_symbol">,</span><span class="sh_usertype">type</span><span class="sh_normal"> </span>mod<span class="sh_symbol">)</span></li><li><span class="sh_cbracket">{</span></li><li>    <span class="sh_keyword">if</span><span class="sh_symbol">(</span>n <span class="sh_symbol">==</span> <span class="sh_number">0</span><span class="sh_symbol">)</span><span class="sh_keyword">return</span> <span class="sh_function">_square_matrix</span><span class="sh_symbol">(</span><span class="sh_number">2</span><span class="sh_symbol">,</span><span class="sh_number">1</span><span class="sh_symbol">);</span></li><li>    <span class="sh_keyword">if</span><span class="sh_symbol">(</span>n <span class="sh_symbol">==</span> <span class="sh_number">1</span><span class="sh_symbol">)</span><span class="sh_keyword">return</span> A<span class="sh_symbol">;</span></li><li>    </li><li>    <span class="sh_usertype">matrix_t</span><span class="sh_normal"> </span>B <span class="sh_symbol">=</span> <span class="sh_function">power</span><span class="sh_symbol">(</span>A<span class="sh_symbol">,</span>n<span class="sh_symbol">/</span><span class="sh_number">2</span><span class="sh_symbol">,</span>mod<span class="sh_symbol">)</span> <span class="sh_symbol">,</span> C <span class="sh_symbol">=</span> <span class="sh_function">multiply</span><span class="sh_symbol">(</span>B<span class="sh_symbol">,</span>B<span class="sh_symbol">,</span>mod<span class="sh_symbol">);</span></li><li>    </li><li>    <span class="sh_keyword">return</span> n<span class="sh_symbol">%</span><span class="sh_number">2</span> <span class="sh_symbol">?</span> <span class="sh_function">multiply</span><span class="sh_symbol">(</span>C<span class="sh_symbol">,</span>A<span class="sh_symbol">,</span>mod<span class="sh_symbol">)</span> <span class="sh_symbol">:</span> C<span class="sh_symbol">;</span></li><li><span class="sh_cbracket">}</span></li><li></li><li><span class="sh_usertype">type</span><span class="sh_normal"> </span><span class="sh_function">Fibonacci</span><span class="sh_symbol">(</span><span class="sh_type">int</span> n<span class="sh_symbol">)</span></li><li><span class="sh_cbracket">{</span></li><li>     <span class="sh_keyword">if</span><span class="sh_symbol">(</span>n <span class="sh_symbol">&lt;=</span> <span class="sh_number">1</span><span class="sh_symbol">)</span><span class="sh_keyword">return</span> <span class="sh_function">type</span><span class="sh_symbol">(</span>n<span class="sh_symbol">);</span></li><li>     </li><li>     <span class="sh_usertype">matrix_t</span><span class="sh_normal"> </span>M <span class="sh_symbol">=</span> <span class="sh_function">_square_matrix</span><span class="sh_symbol">(</span><span class="sh_number">2</span><span class="sh_symbol">,</span><span class="sh_number">1</span><span class="sh_symbol">);</span></li><li>     M<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">][</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span></li><li>             </li><li>     M <span class="sh_symbol">=</span> <span class="sh_function">power</span><span class="sh_symbol">(</span>M<span class="sh_symbol">,</span> n <span class="sh_symbol">+</span> <span class="sh_number">1</span> <span class="sh_symbol">,</span> MOD<span class="sh_symbol">);</span></li><li>     </li><li>     <span class="sh_keyword">return</span> M<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">][</span><span class="sh_number">0</span><span class="sh_symbol">];</span></li><li><span class="sh_cbracket">}</span></li><li></li><li><span class="sh_usertype">type</span><span class="sh_normal"> </span><span class="sh_function">Sum_Fibonacci_0_to_n</span><span class="sh_symbol">(</span><span class="sh_type">int</span> n<span class="sh_symbol">)</span></li><li><span class="sh_cbracket">{</span></li><li>     <span class="sh_keyword">if</span><span class="sh_symbol">(</span>n <span class="sh_symbol">&lt;=</span> <span class="sh_number">1</span><span class="sh_symbol">)</span><span class="sh_keyword">return</span> <span class="sh_function">type</span><span class="sh_symbol">(</span>n<span class="sh_symbol">);</span></li><li>     </li><li>     <span class="sh_usertype">matrix_t</span><span class="sh_normal"> </span>M <span class="sh_symbol">=</span> <span class="sh_function">_square_matrix</span><span class="sh_symbol">(</span><span class="sh_number">3</span><span class="sh_symbol">,</span><span class="sh_number">1</span><span class="sh_symbol">);</span></li><li>     </li><li>     M<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">][</span><span class="sh_number">0</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> M<span class="sh_symbol">[</span><span class="sh_number">0</span><span class="sh_symbol">][</span><span class="sh_number">2</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> M<span class="sh_symbol">[</span><span class="sh_number">1</span><span class="sh_symbol">][</span><span class="sh_number">2</span><span class="sh_symbol">]</span> <span class="sh_symbol">=</span> <span class="sh_number">0</span><span class="sh_symbol">;</span></li><li>             </li><li>     M <span class="sh_symbol">=</span> <span class="sh_function">power</span><span class="sh_symbol">(</span>M<span class="sh_symbol">,</span> n <span class="sh_symbol">,</span> MOD<span class="sh_symbol">);</span></li><li>     </li><li>     <span class="sh_keyword">return</span> M<span class="sh_symbol">[</span><span class="sh_number">2</span><span class="sh_symbol">][</span><span class="sh_number">0</span><span class="sh_symbol">];</span></li><li><span class="sh_cbracket">}</span></li><li></li><li><span class="sh_function">scanf</span><span class="sh_symbol">(</span><span class="sh_string">"%d%d"</span><span class="sh_symbol">,&amp;</span>n<span class="sh_symbol">,&amp;</span>m<span class="sh_symbol">);</span></li><li>        </li><li>_n <span class="sh_symbol">=</span> <span class="sh_function">Sum_Fibonacci_0_to_n</span><span class="sh_symbol">(</span><span class="sh_function">max</span><span class="sh_symbol">((</span>n<span class="sh_number">-1</span><span class="sh_symbol">),</span><span class="sh_number">0</span><span class="sh_symbol">));</span></li><li>_m <span class="sh_symbol">=</span> <span class="sh_function">Sum_Fibonacci_0_to_n</span><span class="sh_symbol">(</span>m<span class="sh_symbol">);</span></li><li></li><li>_m <span class="sh_symbol">-=</span> _n<span class="sh_symbol">;</span></li><li>        </li><li><span class="sh_keyword">if</span><span class="sh_symbol">(</span>_m <span class="sh_symbol">&lt;</span> <span class="sh_number">0</span><span class="sh_symbol">)</span>_m <span class="sh_symbol">+=</span> MOD<span class="sh_symbol">;</span></li><li><span class="sh_function">printf</span><span class="sh_symbol">(</span><span class="sh_string">"%lld</span><span class="sh_specialchar">\n</span><span class="sh_string">"</span><span class="sh_symbol">,</span>_m<span class="sh_symbol">);</span></li></ol></pre>
      <pre class="snippet-textonly sh_sourceCode" style="display:none;" tabindex="0" contenteditable="">typedef long long type;
typedef vector&lt;type&gt; row_t;
typedef vector&lt;row_t&gt; matrix_t;

matrix_t _square_matrix(int size, int value)
{
    return matrix_t(size , row_t(size , value));
}

matrix_t multiply(matrix_t A,matrix_t B,type mod)
{
    int size = A.size();
    
    matrix_t C = _square_matrix(size,0);

    for(int k,j,t,i = 0;i &lt; size;i++)
       for(int j = 0;j &lt; size;j++)
       {
             for(t = k = 0;k &lt; size;k++)
                 t = (t + A[i][k] * B[k][j] % mod) % mod;
                 
             C[i][j] = t;
       }
       
    return C;
}

matrix_t power(matrix_t A,int n,type mod)
{
    if(n == 0)return _square_matrix(2,1);
    if(n == 1)return A;
    
    matrix_t B = power(A,n/2,mod) , C = multiply(B,B,mod);
    
    return n%2 ? multiply(C,A,mod) : C;
}

type Fibonacci(int n)
{
     if(n &lt;= 1)return type(n);
     
     matrix_t M = _square_matrix(2,1);
     M[0][0] = 0;
             
     M = power(M, n + 1 , MOD);
     
     return M[0][0];
}

type Sum_Fibonacci_0_to_n(int n)
{
     if(n &lt;= 1)return type(n);
     
     matrix_t M = _square_matrix(3,1);
     
     M[0][0] = M[0][2] = M[1][2] = 0;
             
     M = power(M, n , MOD);
     
     return M[2][0];
}

scanf("%d%d",&amp;n,&amp;m);
        
_n = Sum_Fibonacci_0_to_n(max((n-1),0));
_m = Sum_Fibonacci_0_to_n(m);

_m -= _n;
        
if(_m &lt; 0)_m += MOD;
printf("%lld\n",_m);</pre>
   </div>
</div>
<!-- end code -->

<!--
          <pre><code>
typedef long long type;
typedef vector<type> row_t;
typedef vector<row_t> matrix_t;

matrix_t _square_matrix(int size, int value)
{
    return matrix_t(size , row_t(size , value));
}

matrix_t multiply(matrix_t A,matrix_t B,type mod)
{
    int size = A.size();
    
    matrix_t C = _square_matrix(size,0);

    for(int k,j,t,i = 0;i < size;i++)
       for(int j = 0;j < size;j++)
       {
             for(t = k = 0;k < size;k++)
                 t = (t + A[i][k] * B[k][j] % mod) % mod;
                 
             C[i][j] = t;
       }
       
    return C;
}

matrix_t power(matrix_t A,int n,type mod)
{
    if(n == 0)return _square_matrix(2,1);
    if(n == 1)return A;
    
    matrix_t B = power(A,n/2,mod) , C = multiply(B,B,mod);
    
    return n%2 ? multiply(C,A,mod) : C;
}

type Fibonacci(int n)
{
     if(n <= 1)return type(n);
     
     matrix_t M = _square_matrix(2,1);
     M[0][0] = 0;
             
     M = power(M, n + 1 , MOD);
     
     return M[0][0];
}

type Sum_Fibonacci_0_to_n(int n)
{
     if(n <= 1)return type(n);
     
     matrix_t M = _square_matrix(3,1);
     
     M[0][0] = M[0][2] = M[1][2] = 0;
             
     M = power(M, n , MOD);
     
     return M[2][0];
}

scanf("%d%d",&n,&m);
        
_n = Sum_Fibonacci_0_to_n(max((n-1),0));
_m = Sum_Fibonacci_0_to_n(m);

_m -= _n;
        
if(_m < 0)_m += MOD;
printf("%lld\n",_m);
          </code></pre>
-->
        </section>

        <footer>
          Notebook is maintained by <a href="https://github.com/aras7">aras7</a><br>
          <a target="blank"href="http://stackoverflow.com/users/1437986/andres">
          <img src="http://stackoverflow.com/users/flair/1437986.png" width="208" height="58" alt="profile for Andres at Stack Overflow, Q&amp;A for professional and enthusiast programmers" title="profile for Andres at Stack Overflow, Q&amp;A for professional and enthusiast programmers">
          </a>
          <br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>       
      </div>
    </div>
  </body>
</html>